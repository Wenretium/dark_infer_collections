import torch

if __name__ == '__main__':
    weight = torch.load('pre_weights/DSLR/Retinex.pkl')
    key_dic = {
        "stage1.conv1_1.weight": "stage1.lmsb_block_d1.model.0.weight",
        "stage1.conv1_1.bias": "stage1.lmsb_block_d1.model.0.bias",
        "stage1.conv1_r1.res_l3.conv1.weight": "stage1.lmsb_block_d1.model.3.res_l3.conv1.weight",
        "stage1.conv1_r1.res_l3.conv1.bias": "stage1.lmsb_block_d1.model.3.res_l3.conv1.bias",
        "stage1.conv1_r1.res_l3.conv2.weight": "stage1.lmsb_block_d1.model.3.res_l3.conv2.weight",
        "stage1.conv1_r1.res_l3.conv2.bias": "stage1.lmsb_block_d1.model.3.res_l3.conv2.bias",
        "stage1.conv1_r1.res_l2.conv1.weight": "stage1.lmsb_block_d1.model.3.res_l2.conv1.weight",
        "stage1.conv1_r1.res_l2.conv1.bias": "stage1.lmsb_block_d1.model.3.res_l2.conv1.bias",
        "stage1.conv1_r1.res_l2.conv2.weight": "stage1.lmsb_block_d1.model.3.res_l2.conv2.weight",
        "stage1.conv1_r1.res_l2.conv2.bias": "stage1.lmsb_block_d1.model.3.res_l2.conv2.bias",
        "stage1.conv1_r1.res_l1.conv1.weight": "stage1.lmsb_block_d1.model.3.res_l1.conv1.weight",
        "stage1.conv1_r1.res_l1.conv1.bias": "stage1.lmsb_block_d1.model.3.res_l1.conv1.bias",
        "stage1.conv1_r1.res_l1.conv2.weight": "stage1.lmsb_block_d1.model.3.res_l1.conv2.weight",
        "stage1.conv1_r1.res_l1.conv2.bias": "stage1.lmsb_block_d1.model.3.res_l1.conv2.bias",
        "stage2.conv1_1.weight": "stage2.lmsb_block_d1.model.0.weight",
        "stage2.conv1_1.bias": "stage2.lmsb_block_d1.model.0.bias",
        "stage2.conv1_r1.res_l2.conv1.weight": "stage2.lmsb_block_d1.model.3.res_l2.conv1.weight",
        "stage2.conv1_r1.res_l2.conv1.bias": "stage2.lmsb_block_d1.model.3.res_l2.conv1.bias",
        "stage2.conv1_r1.res_l2.conv2.weight": "stage2.lmsb_block_d1.model.3.res_l2.conv2.weight",
        "stage2.conv1_r1.res_l2.conv2.bias": "stage2.lmsb_block_d1.model.3.res_l2.conv2.bias",
        "stage2.conv1_r1.res_l1.conv1.weight": "stage2.lmsb_block_d1.model.3.res_l1.conv1.weight",
        "stage2.conv1_r1.res_l1.conv1.bias": "stage2.lmsb_block_d1.model.3.res_l1.conv1.bias",
        "stage2.conv1_r1.res_l1.conv2.weight": "stage2.lmsb_block_d1.model.3.res_l1.conv2.weight",
        "stage2.conv1_r1.res_l1.conv2.bias": "stage2.lmsb_block_d1.model.3.res_l1.conv2.bias",
        "stage3.conv1_1.weight": "stage3.lmsb_block_d1.model.0.weight",
        "stage3.conv1_1.bias": "stage3.lmsb_block_d1.model.0.bias",
        "stage3.conv1_r1.res_l2.conv1.weight": "stage3.lmsb_block_d1.model.3.res_l2.conv1.weight",
        "stage3.conv1_r1.res_l2.conv1.bias": "stage3.lmsb_block_d1.model.3.res_l2.conv1.bias",
        "stage3.conv1_r1.res_l2.conv2.weight": "stage3.lmsb_block_d1.model.3.res_l2.conv2.weight",
        "stage3.conv1_r1.res_l2.conv2.bias": "stage3.lmsb_block_d1.model.3.res_l2.conv2.bias",
        "stage3.conv1_r1.res_l1.conv1.weight": "stage3.lmsb_block_d1.model.3.res_l1.conv1.weight",
        "stage3.conv1_r1.res_l1.conv1.bias": "stage3.lmsb_block_d1.model.3.res_l1.conv1.bias",
        "stage3.conv1_r1.res_l1.conv2.weight": "stage3.lmsb_block_d1.model.3.res_l1.conv2.weight",
        "stage3.conv1_r1.res_l1.conv2.bias": "stage3.lmsb_block_d1.model.3.res_l1.conv2.bias",

        "stage1.conv2_1.weight":               "stage1.lmsb_block_d2.model.0.weight",
        "stage1.conv2_1.bias":                 "stage1.lmsb_block_d2.model.0.bias",
        "stage1.conv2_r1.res_l3.conv1.weight": "stage1.lmsb_block_d2.model.3.res_l3.conv1.weight",
        "stage1.conv2_r1.res_l3.conv1.bias":   "stage1.lmsb_block_d2.model.3.res_l3.conv1.bias",
        "stage1.conv2_r1.res_l3.conv2.weight": "stage1.lmsb_block_d2.model.3.res_l3.conv2.weight",
        "stage1.conv2_r1.res_l3.conv2.bias":   "stage1.lmsb_block_d2.model.3.res_l3.conv2.bias",
        "stage1.conv2_r1.res_l2.conv1.weight": "stage1.lmsb_block_d2.model.3.res_l2.conv1.weight",
        "stage1.conv2_r1.res_l2.conv1.bias":   "stage1.lmsb_block_d2.model.3.res_l2.conv1.bias",
        "stage1.conv2_r1.res_l2.conv2.weight": "stage1.lmsb_block_d2.model.3.res_l2.conv2.weight",
        "stage1.conv2_r1.res_l2.conv2.bias":   "stage1.lmsb_block_d2.model.3.res_l2.conv2.bias",
        "stage1.conv2_r1.res_l1.conv1.weight": "stage1.lmsb_block_d2.model.3.res_l1.conv1.weight",
        "stage1.conv2_r1.res_l1.conv1.bias":   "stage1.lmsb_block_d2.model.3.res_l1.conv1.bias",
        "stage1.conv2_r1.res_l1.conv2.weight": "stage1.lmsb_block_d2.model.3.res_l1.conv2.weight",
        "stage1.conv2_r1.res_l1.conv2.bias":   "stage1.lmsb_block_d2.model.3.res_l1.conv2.bias",
        "stage2.conv2_1.weight":               "stage2.lmsb_block_d2.model.0.weight",
        "stage2.conv2_1.bias":                 "stage2.lmsb_block_d2.model.0.bias",
        "stage2.conv2_r1.res_l2.conv1.weight": "stage2.lmsb_block_d2.model.3.res_l2.conv1.weight",
        "stage2.conv2_r1.res_l2.conv1.bias":   "stage2.lmsb_block_d2.model.3.res_l2.conv1.bias",
        "stage2.conv2_r1.res_l2.conv2.weight": "stage2.lmsb_block_d2.model.3.res_l2.conv2.weight",
        "stage2.conv2_r1.res_l2.conv2.bias":   "stage2.lmsb_block_d2.model.3.res_l2.conv2.bias",
        "stage2.conv2_r1.res_l1.conv1.weight": "stage2.lmsb_block_d2.model.3.res_l1.conv1.weight",
        "stage2.conv2_r1.res_l1.conv1.bias":   "stage2.lmsb_block_d2.model.3.res_l1.conv1.bias",
        "stage2.conv2_r1.res_l1.conv2.weight": "stage2.lmsb_block_d2.model.3.res_l1.conv2.weight",
        "stage2.conv2_r1.res_l1.conv2.bias":   "stage2.lmsb_block_d2.model.3.res_l1.conv2.bias",
        "stage3.conv2_1.weight":               "stage3.lmsb_block_d2.model.0.weight",
        "stage3.conv2_1.bias":                 "stage3.lmsb_block_d2.model.0.bias",
        "stage3.conv2_r1.res_l2.conv1.weight": "stage3.lmsb_block_d2.model.3.res_l2.conv1.weight",
        "stage3.conv2_r1.res_l2.conv1.bias":   "stage3.lmsb_block_d2.model.3.res_l2.conv1.bias",
        "stage3.conv2_r1.res_l2.conv2.weight": "stage3.lmsb_block_d2.model.3.res_l2.conv2.weight",
        "stage3.conv2_r1.res_l2.conv2.bias":   "stage3.lmsb_block_d2.model.3.res_l2.conv2.bias",
        "stage3.conv2_r1.res_l1.conv1.weight": "stage3.lmsb_block_d2.model.3.res_l1.conv1.weight",
        "stage3.conv2_r1.res_l1.conv1.bias":   "stage3.lmsb_block_d2.model.3.res_l1.conv1.bias",
        "stage3.conv2_r1.res_l1.conv2.weight": "stage3.lmsb_block_d2.model.3.res_l1.conv2.weight",
        "stage3.conv2_r1.res_l1.conv2.bias":   "stage3.lmsb_block_d2.model.3.res_l1.conv2.bias",

        "stage1.conv3_1.weight":               "stage1.lmsb_block_d3.model.0.weight",
        "stage1.conv3_1.bias":                 "stage1.lmsb_block_d3.model.0.bias",
        "stage1.conv3_r1.res_l3.conv1.weight": "stage1.lmsb_block_d3.model.3.res_l3.conv1.weight",
        "stage1.conv3_r1.res_l3.conv1.bias":   "stage1.lmsb_block_d3.model.3.res_l3.conv1.bias",
        "stage1.conv3_r1.res_l3.conv2.weight": "stage1.lmsb_block_d3.model.3.res_l3.conv2.weight",
        "stage1.conv3_r1.res_l3.conv2.bias":   "stage1.lmsb_block_d3.model.3.res_l3.conv2.bias",
        "stage1.conv3_r1.res_l2.conv1.weight": "stage1.lmsb_block_d3.model.3.res_l2.conv1.weight",
        "stage1.conv3_r1.res_l2.conv1.bias":   "stage1.lmsb_block_d3.model.3.res_l2.conv1.bias",
        "stage1.conv3_r1.res_l2.conv2.weight": "stage1.lmsb_block_d3.model.3.res_l2.conv2.weight",
        "stage1.conv3_r1.res_l2.conv2.bias":   "stage1.lmsb_block_d3.model.3.res_l2.conv2.bias",
        "stage1.conv3_r1.res_l1.conv1.weight": "stage1.lmsb_block_d3.model.3.res_l1.conv1.weight",
        "stage1.conv3_r1.res_l1.conv1.bias":   "stage1.lmsb_block_d3.model.3.res_l1.conv1.bias",
        "stage1.conv3_r1.res_l1.conv2.weight": "stage1.lmsb_block_d3.model.3.res_l1.conv2.weight",
        "stage1.conv3_r1.res_l1.conv2.bias":   "stage1.lmsb_block_d3.model.3.res_l1.conv2.bias",
        "stage2.conv3_1.weight":               "stage2.lmsb_block_d3.model.0.weight",
        "stage2.conv3_1.bias":                 "stage2.lmsb_block_d3.model.0.bias",
        "stage2.conv3_r1.res_l2.conv1.weight": "stage2.lmsb_block_d3.model.3.res_l2.conv1.weight",
        "stage2.conv3_r1.res_l2.conv1.bias":   "stage2.lmsb_block_d3.model.3.res_l2.conv1.bias",
        "stage2.conv3_r1.res_l2.conv2.weight": "stage2.lmsb_block_d3.model.3.res_l2.conv2.weight",
        "stage2.conv3_r1.res_l2.conv2.bias":   "stage2.lmsb_block_d3.model.3.res_l2.conv2.bias",
        "stage2.conv3_r1.res_l1.conv1.weight": "stage2.lmsb_block_d3.model.3.res_l1.conv1.weight",
        "stage2.conv3_r1.res_l1.conv1.bias":   "stage2.lmsb_block_d3.model.3.res_l1.conv1.bias",
        "stage2.conv3_r1.res_l1.conv2.weight": "stage2.lmsb_block_d3.model.3.res_l1.conv2.weight",
        "stage2.conv3_r1.res_l1.conv2.bias":   "stage2.lmsb_block_d3.model.3.res_l1.conv2.bias",
        "stage3.conv3_1.weight":               "stage3.lmsb_block_d3.model.0.weight",
        "stage3.conv3_1.bias":                 "stage3.lmsb_block_d3.model.0.bias",
        "stage3.conv3_r1.res_l2.conv1.weight": "stage3.lmsb_block_d3.model.3.res_l2.conv1.weight",
        "stage3.conv3_r1.res_l2.conv1.bias":   "stage3.lmsb_block_d3.model.3.res_l2.conv1.bias",
        "stage3.conv3_r1.res_l2.conv2.weight": "stage3.lmsb_block_d3.model.3.res_l2.conv2.weight",
        "stage3.conv3_r1.res_l2.conv2.bias":   "stage3.lmsb_block_d3.model.3.res_l2.conv2.bias",
        "stage3.conv3_r1.res_l1.conv1.weight": "stage3.lmsb_block_d3.model.3.res_l1.conv1.weight",
        "stage3.conv3_r1.res_l1.conv1.bias":   "stage3.lmsb_block_d3.model.3.res_l1.conv1.bias",
        "stage3.conv3_r1.res_l1.conv2.weight": "stage3.lmsb_block_d3.model.3.res_l1.conv2.weight",
        "stage3.conv3_r1.res_l1.conv2.bias":   "stage3.lmsb_block_d3.model.3.res_l1.conv2.bias",

        "stage1.Deconv1_1.weight":               "stage1.lmsb_block_u1.model.1.weight",
        "stage1.Deconv1_1.bias":                 "stage1.lmsb_block_u1.model.1.bias",
        "stage1.Deconv1_r1.res_l3.conv1.weight": "stage1.lmsb_block_u1.model.0.res_l3.conv1.weight",
        "stage1.Deconv1_r1.res_l3.conv1.bias":   "stage1.lmsb_block_u1.model.0.res_l3.conv1.bias",
        "stage1.Deconv1_r1.res_l3.conv2.weight": "stage1.lmsb_block_u1.model.0.res_l3.conv2.weight",
        "stage1.Deconv1_r1.res_l3.conv2.bias":   "stage1.lmsb_block_u1.model.0.res_l3.conv2.bias",
        "stage1.Deconv1_r1.res_l2.conv1.weight": "stage1.lmsb_block_u1.model.0.res_l2.conv1.weight",
        "stage1.Deconv1_r1.res_l2.conv1.bias":   "stage1.lmsb_block_u1.model.0.res_l2.conv1.bias",
        "stage1.Deconv1_r1.res_l2.conv2.weight": "stage1.lmsb_block_u1.model.0.res_l2.conv2.weight",
        "stage1.Deconv1_r1.res_l2.conv2.bias":   "stage1.lmsb_block_u1.model.0.res_l2.conv2.bias",
        "stage1.Deconv1_r1.res_l1.conv1.weight": "stage1.lmsb_block_u1.model.0.res_l1.conv1.weight",
        "stage1.Deconv1_r1.res_l1.conv1.bias":   "stage1.lmsb_block_u1.model.0.res_l1.conv1.bias",
        "stage1.Deconv1_r1.res_l1.conv2.weight": "stage1.lmsb_block_u1.model.0.res_l1.conv2.weight",
        "stage1.Deconv1_r1.res_l1.conv2.bias":   "stage1.lmsb_block_u1.model.0.res_l1.conv2.bias",
        "stage2.Deconv1_1.weight":               "stage2.lmsb_block_u1.model.1.weight",
        "stage2.Deconv1_1.bias":                 "stage2.lmsb_block_u1.model.1.bias",
        "stage2.Deconv1_r1.res_l2.conv1.weight": "stage2.lmsb_block_u1.model.0.res_l2.conv1.weight",
        "stage2.Deconv1_r1.res_l2.conv1.bias":   "stage2.lmsb_block_u1.model.0.res_l2.conv1.bias",
        "stage2.Deconv1_r1.res_l2.conv2.weight": "stage2.lmsb_block_u1.model.0.res_l2.conv2.weight",
        "stage2.Deconv1_r1.res_l2.conv2.bias":   "stage2.lmsb_block_u1.model.0.res_l2.conv2.bias",
        "stage2.Deconv1_r1.res_l1.conv1.weight": "stage2.lmsb_block_u1.model.0.res_l1.conv1.weight",
        "stage2.Deconv1_r1.res_l1.conv1.bias":   "stage2.lmsb_block_u1.model.0.res_l1.conv1.bias",
        "stage2.Deconv1_r1.res_l1.conv2.weight": "stage2.lmsb_block_u1.model.0.res_l1.conv2.weight",
        "stage2.Deconv1_r1.res_l1.conv2.bias":   "stage2.lmsb_block_u1.model.0.res_l1.conv2.bias",
        "stage3.Deconv1_1.weight":               "stage3.lmsb_block_u1.model.1.weight",
        "stage3.Deconv1_1.bias":                 "stage3.lmsb_block_u1.model.1.bias",
        "stage3.Deconv1_r1.res_l2.conv1.weight": "stage3.lmsb_block_u1.model.0.res_l2.conv1.weight",
        "stage3.Deconv1_r1.res_l2.conv1.bias":   "stage3.lmsb_block_u1.model.0.res_l2.conv1.bias",
        "stage3.Deconv1_r1.res_l2.conv2.weight": "stage3.lmsb_block_u1.model.0.res_l2.conv2.weight",
        "stage3.Deconv1_r1.res_l2.conv2.bias":   "stage3.lmsb_block_u1.model.0.res_l2.conv2.bias",
        "stage3.Deconv1_r1.res_l1.conv1.weight": "stage3.lmsb_block_u1.model.0.res_l1.conv1.weight",
        "stage3.Deconv1_r1.res_l1.conv1.bias":   "stage3.lmsb_block_u1.model.0.res_l1.conv1.bias",
        "stage3.Deconv1_r1.res_l1.conv2.weight": "stage3.lmsb_block_u1.model.0.res_l1.conv2.weight",
        "stage3.Deconv1_r1.res_l1.conv2.bias":   "stage3.lmsb_block_u1.model.0.res_l1.conv2.bias",

        "stage1.Deconv2_1.weight":               "stage1.lmsb_block_u2.model.1.weight",
        "stage1.Deconv2_1.bias":                 "stage1.lmsb_block_u2.model.1.bias",
        "stage1.Deconv2_r1.res_l3.conv1.weight": "stage1.lmsb_block_u2.model.0.res_l3.conv1.weight",
        "stage1.Deconv2_r1.res_l3.conv1.bias":   "stage1.lmsb_block_u2.model.0.res_l3.conv1.bias",
        "stage1.Deconv2_r1.res_l3.conv2.weight": "stage1.lmsb_block_u2.model.0.res_l3.conv2.weight",
        "stage1.Deconv2_r1.res_l3.conv2.bias":   "stage1.lmsb_block_u2.model.0.res_l3.conv2.bias",
        "stage1.Deconv2_r1.res_l2.conv1.weight": "stage1.lmsb_block_u2.model.0.res_l2.conv1.weight",
        "stage1.Deconv2_r1.res_l2.conv1.bias":   "stage1.lmsb_block_u2.model.0.res_l2.conv1.bias",
        "stage1.Deconv2_r1.res_l2.conv2.weight": "stage1.lmsb_block_u2.model.0.res_l2.conv2.weight",
        "stage1.Deconv2_r1.res_l2.conv2.bias":   "stage1.lmsb_block_u2.model.0.res_l2.conv2.bias",
        "stage1.Deconv2_r1.res_l1.conv1.weight": "stage1.lmsb_block_u2.model.0.res_l1.conv1.weight",
        "stage1.Deconv2_r1.res_l1.conv1.bias":   "stage1.lmsb_block_u2.model.0.res_l1.conv1.bias",
        "stage1.Deconv2_r1.res_l1.conv2.weight": "stage1.lmsb_block_u2.model.0.res_l1.conv2.weight",
        "stage1.Deconv2_r1.res_l1.conv2.bias":   "stage1.lmsb_block_u2.model.0.res_l1.conv2.bias",
        "stage2.Deconv2_1.weight":               "stage2.lmsb_block_u2.model.1.weight",
        "stage2.Deconv2_1.bias":                 "stage2.lmsb_block_u2.model.1.bias",
        "stage2.Deconv2_r1.res_l2.conv1.weight": "stage2.lmsb_block_u2.model.0.res_l2.conv1.weight",
        "stage2.Deconv2_r1.res_l2.conv1.bias":   "stage2.lmsb_block_u2.model.0.res_l2.conv1.bias",
        "stage2.Deconv2_r1.res_l2.conv2.weight": "stage2.lmsb_block_u2.model.0.res_l2.conv2.weight",
        "stage2.Deconv2_r1.res_l2.conv2.bias":   "stage2.lmsb_block_u2.model.0.res_l2.conv2.bias",
        "stage2.Deconv2_r1.res_l1.conv1.weight": "stage2.lmsb_block_u2.model.0.res_l1.conv1.weight",
        "stage2.Deconv2_r1.res_l1.conv1.bias":   "stage2.lmsb_block_u2.model.0.res_l1.conv1.bias",
        "stage2.Deconv2_r1.res_l1.conv2.weight": "stage2.lmsb_block_u2.model.0.res_l1.conv2.weight",
        "stage2.Deconv2_r1.res_l1.conv2.bias":   "stage2.lmsb_block_u2.model.0.res_l1.conv2.bias",
        "stage3.Deconv2_1.weight":               "stage3.lmsb_block_u2.model.1.weight",
        "stage3.Deconv2_1.bias":                 "stage3.lmsb_block_u2.model.1.bias",
        "stage3.Deconv2_r1.res_l2.conv1.weight": "stage3.lmsb_block_u2.model.0.res_l2.conv1.weight",
        "stage3.Deconv2_r1.res_l2.conv1.bias":   "stage3.lmsb_block_u2.model.0.res_l2.conv1.bias",
        "stage3.Deconv2_r1.res_l2.conv2.weight": "stage3.lmsb_block_u2.model.0.res_l2.conv2.weight",
        "stage3.Deconv2_r1.res_l2.conv2.bias":   "stage3.lmsb_block_u2.model.0.res_l2.conv2.bias",
        "stage3.Deconv2_r1.res_l1.conv1.weight": "stage3.lmsb_block_u2.model.0.res_l1.conv1.weight",
        "stage3.Deconv2_r1.res_l1.conv1.bias":   "stage3.lmsb_block_u2.model.0.res_l1.conv1.bias",
        "stage3.Deconv2_r1.res_l1.conv2.weight": "stage3.lmsb_block_u2.model.0.res_l1.conv2.weight",
        "stage3.Deconv2_r1.res_l1.conv2.bias":   "stage3.lmsb_block_u2.model.0.res_l1.conv2.bias",

        "stage1.Deconv3_1.weight":               "stage1.lmsb_block_u3.model.1.weight",
        "stage1.Deconv3_1.bias":                 "stage1.lmsb_block_u3.model.1.bias",
        "stage1.Deconv3_r1.res_l3.conv1.weight": "stage1.lmsb_block_u3.model.0.res_l3.conv1.weight",
        "stage1.Deconv3_r1.res_l3.conv1.bias":   "stage1.lmsb_block_u3.model.0.res_l3.conv1.bias",
        "stage1.Deconv3_r1.res_l3.conv2.weight": "stage1.lmsb_block_u3.model.0.res_l3.conv2.weight",
        "stage1.Deconv3_r1.res_l3.conv2.bias":   "stage1.lmsb_block_u3.model.0.res_l3.conv2.bias",
        "stage1.Deconv3_r1.res_l2.conv1.weight": "stage1.lmsb_block_u3.model.0.res_l2.conv1.weight",
        "stage1.Deconv3_r1.res_l2.conv1.bias":   "stage1.lmsb_block_u3.model.0.res_l2.conv1.bias",
        "stage1.Deconv3_r1.res_l2.conv2.weight": "stage1.lmsb_block_u3.model.0.res_l2.conv2.weight",
        "stage1.Deconv3_r1.res_l2.conv2.bias":   "stage1.lmsb_block_u3.model.0.res_l2.conv2.bias",
        "stage1.Deconv3_r1.res_l1.conv1.weight": "stage1.lmsb_block_u3.model.0.res_l1.conv1.weight",
        "stage1.Deconv3_r1.res_l1.conv1.bias":   "stage1.lmsb_block_u3.model.0.res_l1.conv1.bias",
        "stage1.Deconv3_r1.res_l1.conv2.weight": "stage1.lmsb_block_u3.model.0.res_l1.conv2.weight",
        "stage1.Deconv3_r1.res_l1.conv2.bias":   "stage1.lmsb_block_u3.model.0.res_l1.conv2.bias",
        "stage2.Deconv3_1.weight":               "stage2.lmsb_block_u3.model.1.weight",
        "stage2.Deconv3_1.bias":                 "stage2.lmsb_block_u3.model.1.bias",
        "stage2.Deconv3_r1.res_l2.conv1.weight": "stage2.lmsb_block_u3.model.0.res_l2.conv1.weight",
        "stage2.Deconv3_r1.res_l2.conv1.bias":   "stage2.lmsb_block_u3.model.0.res_l2.conv1.bias",
        "stage2.Deconv3_r1.res_l2.conv2.weight": "stage2.lmsb_block_u3.model.0.res_l2.conv2.weight",
        "stage2.Deconv3_r1.res_l2.conv2.bias":   "stage2.lmsb_block_u3.model.0.res_l2.conv2.bias",
        "stage2.Deconv3_r1.res_l1.conv1.weight": "stage2.lmsb_block_u3.model.0.res_l1.conv1.weight",
        "stage2.Deconv3_r1.res_l1.conv1.bias":   "stage2.lmsb_block_u3.model.0.res_l1.conv1.bias",
        "stage2.Deconv3_r1.res_l1.conv2.weight": "stage2.lmsb_block_u3.model.0.res_l1.conv2.weight",
        "stage2.Deconv3_r1.res_l1.conv2.bias":   "stage2.lmsb_block_u3.model.0.res_l1.conv2.bias",
        "stage3.Deconv3_1.weight":               "stage3.lmsb_block_u3.model.1.weight",
        "stage3.Deconv3_1.bias":                 "stage3.lmsb_block_u3.model.1.bias",
        "stage3.Deconv3_r1.res_l2.conv1.weight": "stage3.lmsb_block_u3.model.0.res_l2.conv1.weight",
        "stage3.Deconv3_r1.res_l2.conv1.bias":   "stage3.lmsb_block_u3.model.0.res_l2.conv1.bias",
        "stage3.Deconv3_r1.res_l2.conv2.weight": "stage3.lmsb_block_u3.model.0.res_l2.conv2.weight",
        "stage3.Deconv3_r1.res_l2.conv2.bias":   "stage3.lmsb_block_u3.model.0.res_l2.conv2.bias",
        "stage3.Deconv3_r1.res_l1.conv1.weight": "stage3.lmsb_block_u3.model.0.res_l1.conv1.weight",
        "stage3.Deconv3_r1.res_l1.conv1.bias":   "stage3.lmsb_block_u3.model.0.res_l1.conv1.bias",
        "stage3.Deconv3_r1.res_l1.conv2.weight": "stage3.lmsb_block_u3.model.0.res_l1.conv2.weight",
        "stage3.Deconv3_r1.res_l1.conv2.bias":   "stage3.lmsb_block_u3.model.0.res_l1.conv2.bias",
    }
    new_weight = {}
    for k, v in weight['model'].items():
        k = k[7:].replace('Stage', 'stage')

        if k in key_dic.keys():
            
            new_weight[key_dic[k]] = v
        else:
            new_weight[k] = v

    torch.save(new_weight, 'weights/DSLR/weight.pth')
